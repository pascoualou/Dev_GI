function animate_menu(){$("#div_menu").hover(function(){$("#div_menu nav").stop(!0).slideDown()},function(){$("#div_menu nav").stop(!0).slideUp()});var n=$("#menu").find(".k-menu-on");n.parents("ul.ul_menu").addClass("k-ul-on");$("#menu").kendoMenu({direction:"right",orientation:"vertical"})}function setAnimationAjax(n){n==1?$("#divLoaderGlobal").stop(!0).animate({top:"0"},200,function(){$(this).find(".img_loading").show()}):n==2?$("#divLoaderGlobal .img_loading").delay(250).fadeOut(200,function(){$("#divLoaderGlobal .img_loaded").fadeIn(200,function(){window.setTimeout(function(){$("#divLoaderGlobal").animate({top:"-65px"},200,function(){$(this).find("img").hide()})},700)})}):window.setTimeout(function(){$("#divLoaderGlobal").animate({top:"-65px"},200,function(){$(this).find("img").hide()})},400)}function isEmail(n){var t=!1;return n!=""&&n.match(/^[a-zA-Z0-9._-]+@([a-zA-Z-]{1,}[.]){1,}[a-zA-Z]{2,3}$/)&&(t=!0),t}function getUrlVars(n){for(var t,r={},u=n.slice(n.indexOf("?")+1).split("&"),i=0;i<u.length;i++)t=u[i].split("="),r[t[0]]=t[1];return r}function loadUrlHash(){$("body").hide();var n=location.hash.replace("#","").split("_"),i=Array(),r=Array(),u="",t="";for(iHash=0;iHash<n.length;iHash++)u=n[iHash].replace(regHash,""),$.inArray(u,tabInHash)>-1?r.push(n[iHash]):i.push(n[iHash]);t=urlAjax;i.length>0&&(t+="/"+i.join("/"));r.length>0&&(t+="#"+r.join("_"));window.location.href=t}function loadButtonFiche(){$(".k-button-fiche, .btn_retour, #div_ariane a").each(function(){var n=$(this).hasClass("btn_retour")?$("#hid_urlAction"+$(this).attr("id").replace("btn_","")).val():$(this).attr("href");var t="zoom-out-sm",r="zoom-in-sm",i="zoom-in-sm fade-in-left-sm fade-in-right-sm";$(this).unbind("click.load_fiche").bind("click.load_fiche",function(u){if(u.preventDefault(),$(this).hasClass("k-button-fiche")){var f=$(".param").serialize();$.ajax({url:n,dataType:"html",type:"POST",data:f,beforeSend:function(){setAnimationAjax(1)},complete:function(){setAnimationAjax(0)},success:function(u){var h=n.split("/"),f=n.replace(urlAjax,"");f.charAt(0)=="/"&&(f=f.substring(1));var e=location.hash.replace("#","").split("_"),o=Array(),s="";for(iHash=0;iHash<e.length;iHash++)s=e[iHash].replace(regHash,""),$.inArray(s,tabInHash)>-1&&o.push(e[iHash]);o.length>0&&(f+="_"+o.join("_"));location.hash=f.replace(new RegExp("/","g"),"_");$("body main.animsition").removeClass(i).addClass(t).fadeTo("slow",.3,function(){$(".k-popup, .k-window").remove();$(this).html(u).removeClass(t).addClass(r)}).fadeTo("slow",1,function(){})},error:function(){loadDialogMessage(null,"Erreur",!1)}})}else $("body main.animsition").removeClass(i).addClass(t),window.location.href=n})})}function loadToTop(){$(".toTop").each(function(){var t=$("body,html"),i=$(window),n=$(this);n.closest(".k-window-content").length>0&&($parentDiv=n.closest(".k-window-content"),t=$parentDiv,i=$parentDiv,n.css("margin-top",-$parentDiv[0].scrollHeight+$parentDiv.height()-(150+$(window).scrollTop())),n.css("margin-left",$parentDiv.innerWidth()-70));i.scroll(function(){var t=$(this).scrollTop();t>50?n.fadeIn():n.fadeOut()});n.unbind("click").bind("click",function(){t.animate({scrollTop:0},500)})})}function loadTitle(){$("a[title]:not(#div_menu a), img[title], input[title], div.title[title], .k-ellipsis[title]").removeData("qtip");$(".qtip").each(function(){$(this).remove()});$("a[title]:not(#div_menu a), img[title], input[title], div.title[title], .k-ellipsis[title]").each(function(){var t="bottom center",r="top center",u,n;if($(this).hasClass("qtip-position")){if(u=$(this).attr("class"),u.indexOf(" ")!=-1&&(n=u.split(" "),n.length>0))for(i=0;i<n.length;i++)n[i].substr(0,8)=="qtip-my-"&&(t=n[i].replace("qtip-my-","").replace("_"," ")),n[i].substr(0,8)=="qtip-at-"&&(r=n[i].replace("qtip-at-","").replace("_"," "))}else $(this).offset().top<=60?(t="top right",r="bottom left",$(this).offset().left<=100&&(t="top left",r="bottom right")):$(this).offset().left<=100&&(t="top left",r="bottom right");$("body").data("qtip_my",t);$("body").data("qtip_at",r);$(this).qtip({position:{my:$("body").data("qtip_my"),at:$("body").data("qtip_at")},hide:{fixed:!0},style:{classes:"ui-tooltip-shadow ui-tooltip-magi"}})})}function toggleImageHover(){$(".k-button-hover:not(.k-img_on) img, input[type=image].k-button-hover").each(function(){$(this).hover(function(){$(this).attr("src",$(this).attr("src").replace("/off/","/on/"))},function(){$(this).attr("src",$(this).attr("src").replace("/on/","/off/"))})});$(".k-button-hover.k-img_on img").each(function(){$(this).hover(function(){$(this).attr("src",$(this).attr("src").replace("/off/","/on/"))},function(){$(this).attr("src",$(this).attr("src").replace("/off/","/on/"))})})}function loadHtmlFunction(){toggleImageHover();loadTitle();loadWindowStandard()}function checkAll(){var t="",n=Array(),r="",u,f;$(".check_all").each(function(){if(r=$(this).attr("class"),r.indexOf(" ")!=-1&&(n=r.split(" "),n.length>0))for(i=0;i<n.length;i++)n[i].substr(0,6)=="check_"&&n[i]!="check_all"&&(t="."+n[i],$(this).unbind("click.CheckAll").bind("click.CheckAll",function(){$(this).is(":checked")?$(t).prop("checked",!0):$(t).prop("checked",!1)}))});u=0;f=0;$(".check_one").each(function(){if(r=$(this).attr("class"),r.indexOf(" ")!=-1&&(n=r.split(" "),n.length>0))for(i=0;i<n.length;i++)n[i].substr(0,6)=="check_"&&n[i]!="check_one"&&(t="."+n[i],$(this).unbind("click.CheckOne").bind("click.CheckOne",function(){$(this).is(":checked")?(u=$(".check_one"+t).length,f=$(".check_one"+t+":checked").length,u==f&&$(t+".check_all").prop("checked",!0)):$(t+".check_all").prop("checked",!1)}))})}function setEditMode(){$("#hid_editMode").val("1");$.ajax({url:$("#hid_urlActionEditMode").val()+"&state=1",dataType:"html",type:"POST",async:!1,success:function(){$("#ToolbarActionGlobal .k-edit-mode").removeClass("k-img_on").addClass("k-img_on");loadHtmlFunction();$("#ToolbarActionGlobal .k-edit-mode img").attr("src",$("#ToolbarActionGlobal .k-edit-mode img").attr("src").replace("/off/","/on/"));$("#div_nav_fleche").hide();$(".view_mode").fadeOut(function(){$(".edit_mode").fadeIn(function(){$(".edit_mode .templateDetailBottom").length>0&&$(".edit_mode .templateDetailBottom").show();$(this).find(".k-grid-autobind").length>0&&$(this).find(".k-grid-autobind").each(function(){$(this).data("kendoGrid").dataSource.read();$(this).removeClass("k-grid-autobind")});$(this).find(".k-grid-databound").length>0&&$(this).find(".k-grid-databound").each(function(){onDataBoundGridStandard($(this).data("kendoGrid"))});$(window).trigger("resize")})})},error:function(){loadDialogMessage(null,"Erreur",!1)}})}function setViewMode(){$("#hid_editMode").val("0");$.ajax({url:$("#hid_urlActionEditMode").val()+"&state=0",dataType:"html",type:"POST",async:!1,success:function(){$("#ToolbarActionGlobal .k-edit-mode").removeClass("k-img_on");loadHtmlFunction();$("#ToolbarActionGlobal .k-edit-mode img").attr("src",$("#ToolbarActionGlobal .k-edit-mode img").attr("src").replace("/on/","/off/"));$("#div_nav_fleche").show();$(".edit_mode").fadeOut(function(){$(".view_mode").fadeIn(function(){$(".view_mode .templateDetailBottom").length>0&&$(".view_mode .templateDetailBottom").show();$(this).find(".k-grid-autobind").length>0&&$(this).find(".k-grid-autobind").each(function(){$(this).data("kendoGrid").dataSource.read();$(this).removeClass("k-grid-autobind")});$(window).trigger("resize")})});$(window).trigger("resize")},error:function(){loadDialogMessage(null,"Erreur",!1)}})}function onDataBoundGridDetailBottom(n){var i=n.tbody.find("tr.k-master-row").first(),r,t;i.length>0&&(n.expandRow(n.tbody.find("tr.k-master-row")),i.addClass("k-state-selected"),r=i.next().find(".div_detail").html().replace(/&amp;#/g,"&#"),t=i.next().find(".div_detail").attr("id").replace("div_detail",""),i.next().find(".div_detail").empty(),i.closest(".mode").find(".templateDetailBottom").html(r).attr("id","templateDetailBottom"+t).show(),$("#templateDetailBottom"+t).find(".k-grid-autobind-detail").length>0?$("#templateDetailBottom"+t).find(".k-grid-autobind-detail").each(function(){var n=$(this);window.setTimeout(function(){n.data("kendoGrid").dataSource.read();n.removeClass("k-grid-autobind-detail").addClass("k-grid-databound")},100)}):$("#templateDetailBottom"+t).find(".k-grid-databound").length>0&&$("#templateDetailBottom"+t).find(".k-grid-databound").each(function(){var n=$(this);window.setTimeout(function(){onDataBoundGridStandard(n.data("kendoGrid"))},100)}),$("#templateDetailBottom"+t+" .datepicker").each(function(){$(this).removeClass("k-textbox").kendoDatePicker({format:"dd/MM/yyyy"})}));onDataBoundGridStandard(n)}function onDataBoundGridStandard(n){var grid=this,t;typeof n.sender==typeof undefined&&typeof n=="object"&&(grid=n);grid.element.removeClass("k-grid_trigger");grid.element.find(".k_table_scroll").length==0&&$(grid.table).wrap('<div class="k_table_scroll"><\/div>');grid.element.find(".td_action").each(function(){$(this).find(".k-toolbar-line").hasClass("k-toolbar")&&($(this).find(".k-toolbar").data("kendoToolBar").destroy(),$(this).find(".k-toolbar").empty());eval($(this).children("script").last().html());$(this).find(".k-toolbar-line:visible").each(function(){$(this).data("kendoToolBar").resize();$(this).find(".k-button-icon").each(function(){$(this).unbind("click.img_action").bind("click.img_action",function(){grid.element.addClass("k-grid_img_action")})})})});grid.element.find(".k-ellipsis").each(function(){var n=$(this).get(0);n.scrollWidth<=$(this).width()&&$(this).removeClass("k-ellipsis").removeAttr("title")});grid.element.hasClass("k-grid_window")&&(t=grid.element.closest(".k-window-content").data("kendoWindow"),t.element.find(".main_window").length>0&&t.element.find(".main_window").show(),t.center());grid.element.removeClass("k-grid_loaded");grid.dataSource.total()>0&&grid.element.addClass("k-grid_loaded");loadButtonFiche();loadHtmlFunction()}function saveOptionGrid(n){var t=n.target;t.unbind("click").bind("click",function(n){n.preventDefault();var r=t.closest(".k-grid").data().kendoGrid,i=r.dataSource,u={columns:r.columns,page:i.page(),pageSize:i.pageSize(),sort:i.sort(),filter:i.filter(),group:i.group()},f=t.closest(".k-grid").attr("id");$.ajax({url:"/Application/Kendo/SaveGridOption",type:"POST",dataType:"json",beforeSend:function(){setAnimationAjax(1)},complete:function(){setAnimationAjax(2)},data:{url:window.location.pathname,grid:f,dataGrid:JSON.stringify(u)}})})}function loadPreferenceUser($grid){var grid=$grid.data("kendoGrid"),dataGrid,options,toolbarHtml,$tr_col,nb_col,dataForm,$form;if(grid){var dataSource=grid.dataSource,$divAction=grid.element.find("#ActionGlobale"),idgrid=$grid.attr("id"),flag_autobind=!1;$grid.hasClass("k-grid-autobind")&&(flag_autobind=!0);$divAction.find(".k-preference-dataGrid").length>0&&(dataGrid=$divAction.find(".k-preference-dataGrid").val(),dataGrid!=""&&(dataGrid=JSON.parse(dataGrid),options=grid.getOptions(),options.columns=dataGrid.columns,options.dataSource.page=dataGrid.page,options.dataSource.pageSize=dataGrid.pageSize,options.dataSource.sort=dataGrid.sort,options.dataSource.filter=dataGrid.filter,options.dataSource.group=dataGrid.group,options.dataSource.total=1,toolbarHtml=$("#toolbarTemplate_"+idgrid).html()+"<script>jQuery(function(){ loadTitle();toggleImageHover(); });",options.toolbar=[{template:toolbarHtml}],grid.destroy(),grid=$grid.empty().kendoGrid(options).data("kendoGrid"),$divAction=grid.element.find("#ActionGlobale"),$grid=grid.element,flag_autobind&&$grid.addClass("k-grid-autobind"),$grid.find(".k-grid-toolbar").each(function(){$(this).find(".k-toolbar-global").length>0&&$(this).removeClass("k-grid-top").addClass("k-grid-top")}),$grid.find(".k-grid-header tr").length>0&&($tr_col=$grid.find(".k-grid-header tr").eq(0),$grid.find(".k-grid-header tr").length>1&&($tr_col=$grid.find(".k-grid-header tr").eq(1),$grid.find(".k-grid-header tr").eq(0).find(".k-header[role=columnheader]").removeClass("k-header-group").addClass("k-header-group")),nb_col=$tr_col.find("th.k-header[role=columnheader]").length,$grid.find("tbody[role=rowgroup]").is(":empty")&&$grid.find("tbody[role=rowgroup]").html('<tr class="k-no-data"><td colspan="'+nb_col+'" style="display: none;"><\/td><\/tr>')),$grid.find(".k-grid-pager ul.k-pager-numbers").length>0&&$grid.find(".k-grid-pager ul.k-pager-numbers").is(":empty")&&$grid.find(".k-grid-pager ul.k-pager-numbers").html('<li><span class="k-state-selected" data-page="1">1<\/span><\/li>'),$grid.find(".k-grid-pager .k-pager-input input.k-textbox").length>0&&$grid.find(".k-grid-pager .k-pager-input input.k-textbox").val()==""&&$grid.find(".k-grid-pager .k-pager-input input.k-textbox").attr("type","text").attr("value",1),$grid.find(".k-grid-pager .k-pager-info").length>0&&$grid.find(".k-grid-pager .k-pager-info").is(":empty")&&$grid.find(".k-grid-pager .k-pager-info").text(options.pageable.messages.empty),$("#scriptLoadGrid_"+idgrid).length>0&&eval($("#scriptLoadGrid_"+idgrid).html()),$divAction.find(".k-preference-dataGrid").remove()));($divAction.find(".k-preference-dataForm").length>0||$divAction.find(".k-preference_global-dataForm").length>0)&&(dataForm=$divAction.find(".k-preference-dataForm").length>0&&$divAction.find(".k-preference-dataForm").val()!=""?$divAction.find(".k-preference-dataForm").val():$divAction.find(".k-preference_global-dataForm").val(),dataForm!=""&&(dataForm=JSON.parse(dataForm),$form=$(".k-window_"+idgrid+" form"),$form.length>0&&($form.loadJSON(getUrlVars($.param(dataForm))),$divAction.find(".k-preference-dataForm").length>0&&$divAction.find(".k-preference-dataForm").val()!=""&&!flag_autobind&&!$grid.hasClass("k-grid_noload")&&(grid.element.addClass("k-grid_trigger"),$form.trigger("submit")))),$divAction.find(".k-preference-dataForm").length>0&&$divAction.find(".k-preference-dataForm").remove());flag_autobind&&grid.dataSource.read()}}function getFormDataForGrid(n){var i=$("#RechercheAvancee form, .param_global_form, .div_param_global_form :input"),r,t;return $.isPlainObject(n)||n==null||(i=$(".param_global_form, "+n)),r=i.serializeArray(),t={},$.map(r,function(n){var i=n.value;$("#"+n.name).length>0?$("#"+n.name).is("input")||$("#"+n.name).is("textarea")?($("#"+n.name).is("input")&&$("#"+n.name).attr("type")=="checkbox"&&(i=$("#"+n.name).is(":checked")==!0?!0:!1),t[n.name]=i):$("#"+n.name).is("select")&&(n.name in t?t[n.name]+=","+n.value:t[n.name]=n.value):($("input[type=radio][name="+n.name+"]").length>0&&(i=$("input[type=radio][name="+n.name+"]:checked").length>0?$("input[type=radio][name="+n.name+"]:checked").val():""),t[n.name]=i)}),t}function loadClickDetail(n){window.setTimeout(function(){n.select().each(function(){var t=$(this),i=!0;n.element.hasClass("k-grid_no_close_detail")&&idtr_selected_detail_row==t.attr("data-uid")&&(i=!1);i&&(n.tbody.find(".div_detail:visible").length>0?n.tbody.find(".div_detail:visible").slideUp(400,"swing",function(){$(this).hide();n.collapseRow($(this).closest(".k-detail-row").prev());slideDetailGrid(n,t)}):slideDetailGrid(n,t))})},100)}function slideDetailGrid(n,t){var i=!1,r;(t.hasClass("k-tr-open")||(typeof event!=typeof undefined&&(r=event.target?$(event.target):$(event.srcElement),(r.hasClass("td_action")||r.closest("td").hasClass("td_action"))&&(i=!0)),n.element.hasClass("k-grid_img_action")&&(i=!0),!i))&&(idtr_selected_detail_row!=t.attr("data-uid")||!t.hasClass("k-tr-open")&&t.next().is("tr.k-detail-row")?(n.expandRow(n.tbody.find("tr.k-state-selected")),t.next("tr.k-detail-row").find(".div_detail").slideDown(),idtr_selected_detail_row=t.attr("data-uid"),t.removeClass("k-state-selected").addClass("k-state-selected").removeClass("k-tr-open").addClass("k-tr-open")):t.removeClass("k-state-selected").removeClass("k-tr-open"))}function loadDetailGridBottom($grid,callback){$grid.each(function(){var n=$(this).data("kendoGrid");n.select().each(function(){var i,n;$(this).closest(".mode").find(".templateDetailBottom").hide();$(this).closest(".mode").find(".templateDetailBottom .k_table_scroll").length>0&&$(this).closest(".mode").find(".templateDetailBottom .k_table_scroll>table").each(function(){$(this).unwrap()});$(this).closest(".mode").find(".templateDetailBottom .datepicker").each(function(){$(this).parent().is("span")&&($(this).unwrap().unwrap(),$(this).closest("td").find("span").remove());var n=$(this).data("kendoDatePicker");n&&n.destroy()});var r=$(this).closest(".mode").find(".templateDetailBottom").html(),u=$(this).closest(".mode").find(".templateDetailBottom").attr("id").replace("templateDetailBottom",""),t=$(this);t.closest(".mode").find(".templateDetailBottom").empty();$("#div_detail"+u).html(r);t.next().is("tr.k-detail-row")&&(i=t.next().find(".div_detail").html().replace(/&amp;#/g,"&#"),n=t.next().find(".div_detail").attr("id").replace("div_detail",""),t.next().find(".div_detail").empty(),t.closest(".mode").find(".templateDetailBottom").html(i).attr("id","templateDetailBottom"+n).show(),$(".mode:visible #templateDetailBottom"+n).find(".k-grid-autobind-detail").length>0&&$(".mode:visible #templateDetailBottom"+n).find(".k-grid-autobind-detail").each(function(){var n=$(this);window.setTimeout(function(){n.data("kendoGrid").dataSource.read();n.removeClass("k-grid-autobind-detail").addClass("k-grid-databound")},100)}),$(".mode:visible #templateDetailBottom"+n).find(".k-grid-databound").length>0&&$(".mode:visible #templateDetailBottom"+n).find(".k-grid-databound").each(function(){var n=$(this);onDataBoundGridStandard(n.data("kendoGrid"))}),$(".mode:visible #templateDetailBottom"+n+" .datepicker").each(function(){$(this).removeClass("k-textbox").removeClass("k-input").kendoDatePicker({format:"dd/MM/yyyy"})}))})});callback!=null&&eval(callback)}function onChangeRowGridAngular(n,t){var r,e;onDataBoundGridStandard(n);var i="edit_mode",u="View",f="Edit";n.element.closest(".mode").hasClass("edit_mode")&&(i="view_mode",u="Edit",f="View");r=n.element.attr("id").replace(u,f);e=$("#"+t+" ."+i+" #"+r+" .k_table_scroll>table tr[id="+n.select().attr("id").replace(u,f)+"]");e.length>0&&($("#"+t+" ."+i+" #"+r+" tr").removeClass("k-state-selected"),e.addClass("k-state-selected"),$("#"+t+" ."+i+" #div_detail_"+r).length>0&&$("#"+t+" ."+i+" #div_detail_"+r).show())}function onExcelClickGridStandard(){setAnimationAjax(1)}function onExcelDoneGridStandard(n){var t,i,u,r;for(setAnimationAjax(2),t=n.workbook.sheets[0],t.rows[0].type=="header"&&t.rows[1].type=="header"&&(t.rows.shift(),t.freezePane.rowSplit=1),i=1;i<t.rows.length;i++)if(i%2==0)for(u=t.rows[i],r=0;r<u.cells.length;r++)u.cells[r].background="#ebebeb"}function onSubmitRechercherGrid(n){var r=n.data("kendoGrid"),i=[],t=$(".form_filter_grid:visible .filterGrid").val();t&&$.each(r.columns,function(n,r){if(typeof r.field!=typeof undefined){var u="string";typeof r.type!=typeof undefined&&(u=r.type);switch(u){case"number":isNaN(parseInt(t))||i.push({field:r.field,operator:"eq",value:parseInt(t)});break;default:i.push({field:r.field,operator:"contains",value:t})}}});r.dataSource.filter({logic:"or",filters:i})}function afficheKgridFirstEnum(n,t){return n[0][t]}function afficheKgridDonneeAnnuaire(n,t,i){var r="-";return $.each(n,function(n,u){u.Identifiant==t&&$.each(u.Liste,function(n,t){t.Code==i&&(r=t.Libelle)})}),r}function openWindowUI(n){n.data("kendoWindow").open()}function onActivateWindowStandard(n){loadPanelBarRecherche();$("#RechercheAvancee form").unbind("submit").bind("submit",function(t){var i;t.preventDefault();var r=getFormDataForGrid(),u=n.attr("id"),f=r,e=$(".k-window_"+u+" form").attr("id");r.url=window.location.pathname;r.form=e;r.dataForm=JSON.stringify(f);n.find(".k-grid-pager .k-pager-input input").length>0&&n.find(".k-grid-pager .k-pager-input input").val(1);i=n.data("kendoGrid");n.hasClass("k-grid_signalr")?(n.hasClass("k-grid_trigger")||i.dataSource.transport.hub.connection.stop(),i.dataSource.transport.hub.connection.start().done(function(){i.element.removeClass("k-grid_trigger");i.dataSource.transport.parameterMap=function(){return r};i.dataSource.page(1);i.dataSource.bind();n.hasClass("k-grid_loaded")&&i.dataSource.read()})):(i.dataSource.transport.options.read.url=$("#RechercheAvancee form").attr("action"),i.dataSource.transport.options.read.data=r,i.dataSource.page(1))})}function loadDialogMessage(n,t,i,r,u){$("#div_dialog_alert").empty();n==null&&(n="<p>Une erreur est survenue.<\/p>");n+=i==!0?buttonConfirm:buttonOk;var f=$("#div_dialog_alert").data("kendoWindow");f?(f.title(t),f.content(n),f.refresh()):(f=$("#div_dialog_alert").kendoWindow({title:t,resizable:!1,modal:!0}).data("kendoWindow"),f.content(n));f.center().open();$("#div_dialog_alert").find(".b-confirm,.b-cancel").one("click",function(){$(this).hasClass("b-confirm")&&r();$(this).hasClass("b-cancel")&&typeof u!=typeof undefined&&u();f.close()}).end()}function loadWindowStandard(){$(".k-button-window").each(function(){var u=$(this).attr("href"),f=$(this).attr("data-window-title"),n=typeof $(this).attr("data-window-width")!=typeof undefined&&$(this).attr("data-window-width")!==!1?$(this).attr("data-window-width"):"",t=typeof $(this).attr("data-window-height")!=typeof undefined&&$(this).attr("data-window-height")!==!1?$(this).attr("data-window-height"):"",i=typeof $(this).attr("data-window-maxheight")!=typeof undefined&&$(this).attr("data-window-maxheight")!==!1?$(this).attr("data-window-maxheight"):"",r=typeof $(this).attr("data-window-minheight")!=typeof undefined&&$(this).attr("data-window-minheight")!==!1?$(this).attr("data-window-minheight"):"";$(this).unbind("click").bind("click",function(e){var l;e.preventDefault();var a=$("#div_window_standard"),o="auto",s="auto",h="auto",c="auto";n!=""&&(o=n);t!=""&&(s=t);i!=""&&(h=i);r!=""&&(c=r);l=$("#div_window_standard").kendoWindow({title:f,resizable:!1,modal:!0,content:u,width:o,height:s,maxHeight:h,minHeight:c,activate:function(){},refresh:function(){this.center();this.element.find(".topTop").remove();$("<div/>").addClass("toTop").appendTo(this.element);loadToTop()},deactivate:function(){this.destroy();$("<div/>").attr("id","div_window_standard").appendTo($("#corps"))}}).data("kendoWindow");l.center().open()})})}function onClickResetFormulaire(){var u=!1,f=this.element.closest(".k-window"),r,n,e,t;if(f&&(r=f.attr("class"),r.indexOf(" ")!=-1&&(n=r.split(" "),n.length)))for(i=0;i<n.length;i++)n[i].substr(0,13)=="k-window_grid"&&(e=n[i].replace("k-window_",""),t=$("#"+e),t.find(".k-preference_global-dataForm").length>0&&t.find(".k-preference_global-dataForm").val()!=""&&(loadPreferenceUser(t),u=!0));u==!1&&this.element.closest("form").clearForm()}function onStartSortableTabStrip(n){var t=n.item.closest(".k-tabstrip").data("kendoTabStrip");t.activateTab(n.item)}function onChangeSortableTabStrip(n){var t=n.item.closest(".k-tabstrip").data("kendoTabStrip"),i=t.tabGroup.children().eq(n.newIndex);n.oldIndex<n.newIndex?t.insertAfter(n.item,i):t.insertBefore(n.item,i)}function activateTabStripMenu(){var n=location.hash,u="",t,f,r,i;if(n.indexOf("_")>-1)for(t=Array(),t=n.split("_"),iHash=0;iHash<t.length;iHash++)t[iHash].indexOf("ong")>-1&&(u=t[iHash]);else u=n;f=u.replace("ong","").replace("#","").split("-");$(".nav_onglet").length>0&&(r=!1,location.hash!=""&&location.hash!="#"&&(n=location.hash,i=1,(n.match(/ong[0-9]-[0-9]/g)||[]).length>0?(i=parseInt(f[0])+1,$(".nav_onglet").data("kendoTabStrip").activateTab($("#li-onglet-"+i)),r=!0):(n.match(/ong[0-9]/g)||[]).length>0&&(i=parseInt(n.replace("ong","").replace("#",""))+1,$(".nav_onglet").data("kendoTabStrip").activateTab($("#li-onglet-"+i)),r=!0)),r==!1&&$(".nav_onglet").data("kendoTabStrip").activateTab($("#li-onglet-1")))}function onSelectTabStripMenu(n){var i=n.item,f=$(i.closest(".k-tabstrip-items")).find("li"),t="#",e=$(i.closest(".k-tabstrip-items")).parent(),r=!1,u;e.hasClass("k-tabstrip-left")&&(r=!0);location.hash!=""&&location.hash!="#"?(t=location.hash,r==!1?(t=(t.match(/ong[0-9]-[0-9]/g)||[]).length>0?t.replace(/ong[0-9]-[0-9]/g,""):t.replace(/ong[0-9]/g,""),t!="#"&&t.slice(-1)!="_"&&(t+="_"),t+="ong"):(t.match(/ong[0-9]-[0-9]/g)||[]).length>0?(u=t.match(/ong[0-9]/g),t=t.replace(/ong(\d+)-(\d+)/g,"ong"+u[0].replace("ong","")+"-")):t=t+"-"):t+="ong";location.hash=t+$(f).index($(i))}function onSelectTabStripMenuOnglet(n){var r=$(n.item).parent().find("li.k-item.k-state-active"),t=r.attr("id").replace(regInt,""),i=$("#onglet-"+t);i.length>0&&(kendo.destroy(i),i.empty(),$(".k-widget_onglet-"+t).length>0&&($(".k-widget_onglet-"+t).each(function(){kendo.destroy($(this))}),$(".k-widget_onglet-"+t).remove()))}function setClassWindowOnglet(n){var u=$("#onglet").data("kendoTabStrip"),f,i,t,r;if(typeof u!=typeof undefined)for(f=u.select(),i=f.attr("id").replace(regInt,""),t=0;t<n.length;t++)typeof n[t]!=typeof undefined&&(r=n[t].closest(".k-window"),r.length>0&&r.removeClass("k-widget_onglet-"+i).addClass("k-widget_onglet-"+i))}function onContentLoadTabStripMenu(n){var r=location.hash,i=r.replace("ong","").replace("#","").split("-"),t;$("#"+$(n.item).attr("aria-controls")+" .k-tabstrip").length>0&&(t=0,isNaN(parseInt(i[1]))||(t=parseInt(i[1])),$("#"+$(n.item).attr("aria-controls")+" .k-tabstrip").data("kendoTabStrip").select(t));loadHtmlFunction()}function onContentLoadTabStripStandard(){var t=parseInt($("#hid_editMode").val()),n="view_mode";t==1&&(n="edit_mode");$("."+n).fadeIn(function(){loadHtmlFunction();$(this).find(".k-grid-autobind").length>0&&$(this).find(".k-grid-autobind").each(function(){$(this).data("kendoGrid").dataSource.read();$(this).removeClass("k-grid-autobind")})})}function onActivateTabStripMenuOnglet(n){$(n.contentElement).find(".k-chart").length>0&&(window.setTimeout(function(){$(n.contentElement).find(".k-chart").each(function(){var n=$(this).data("kendoChart");n.refresh()})},200),$(window).resize(function(){$(".k-chart").each(function(){var n=$(this).data("kendoChart");n.refresh()})}));$(n.contentElement).find(".gridster").length>0&&loadGridster()}function loadGridster(){var t=1,n={};$(".gridster").css("visibility","hidden");$(".gridster li").each(function(){typeof n[parseInt($(this).attr("data-row"))]==typeof undefined&&(n[parseInt($(this).attr("data-row"))]=0);n[parseInt($(this).attr("data-row"))]+=parseInt($(this).attr("data-sizex"))});for(keyRow in n)t=n[keyRow]>t?n[keyRow]:t;widthContainerWidget==0&&(widthContainerWidget=$("#corps main").width()+10);$(".gridster").width(widthContainerWidget);var r=(widthContainerWidget-20*t)/t,i=125,u=150;$(".gridster li.encart").each(function(){$(this).css({visibility:"hidden"});var n=parseFloat($(this).prop("scrollHeight"));n>i&&n<=u&&(i=n+5);$(this).css({visibility:"visible"})});$gridster=$(".gridster > ul").gridster({widget_margins:[10,10],widget_base_dimensions:[r,i],min_cols:1,draggable:{handle:"h2.titre_encart .handle_widget",stop:function(){saveWidgetGrid()}},resize:{enabled:!0,stop:function(){loadScrollWidget();$(window).trigger("resize");saveWidgetGrid()}},serialize_params:function(n,t){return{id:$(n).attr("id").replace("encart",""),col:t.col,row:t.row,size_x:t.size_x,size_y:t.size_y}}}).data("gridster");loadWidget();$(".gridster").css("visibility","visible")}function loadWidget(){loadCloseWidget();loadWidgetPlus();loadScrollWidget()}function loadScrollWidget(){$(".gridster li.encart").each(function(){var n=$(this).outerHeight();parseInt($(this).attr("data-sizey"))<4?$(this).find(".relative").height(n*.86):$(this).find(".relative").height(n*.96);$(this).find(".tojq_scrollbar").scrollbar({ignoreMobile:!0})})}function loadCloseWidget(){$("body").on("mouseenter",".encart h2.titre_encart",function(){$(this).stop(!0).find(".close").fadeIn(200)}).on("mouseleave",".encart h2.titre_encart",function(){$(this).stop(!0).find(".close").fadeOut(200)});$("body").on("click",".encart h2.titre_encart .close",function(){var t=$(this).parent().text(),n=$(this).closest(".encart").attr("id"),i=$(this).closest(".encart").attr("class");$gridster.remove_widget($(this).closest("li"),function(){$("#btn_widget_plus").fadeIn();$("#widget_plus .div_marge").append('<div class="encart widget" title="Ajouter" id="widget_'+n+'"><input type="hidden" name="class_'+n+'" id="class_'+n+'" value="'+i+'" /><h4>'+t+"<\/h4><\/div>");loadTitle();saveWidgetGrid()})})}function loadWidgetPlus(){$("#widget_plus .div_marge .encart").length>0&&$("#btn_widget_plus").fadeIn();$("body").off("click","#widget_plus .close").off("click","#btn_widget_plus .backbutton").off("click","#widget_plus .div_marge .bgencart");$("body").on("click","#widget_plus .close",function(){$("#widget_plus").animate({bottom:"-260px"},500,function(){$("#widget_plus .div_marge .encart").length>0&&$("#btn_widget_plus").fadeIn()})});$("body").off("click","#btn_widget_plus .k-button").on("click","#btn_widget_plus .k-button",function(){$("#widget_plus").show();$("#widget_plus").animate({bottom:"0px"},500,function(){$("#btn_widget_plus").hide()})});$("body").off("click","#widget_plus .div_marge .encart").on("click","#widget_plus .div_marge .encart",function(){var n=$(this).attr("id").replace("widget_",""),t=$(this);$.ajax({url:$("#hid_urlSyntheseWidget").val(),dataType:"json",type:"POST",data:{widgetId:n},beforeSend:function(){setAnimationAjax(1)},complete:function(){setAnimationAjax(0)},success:function(i){var f=i.html,u=$.parseJSON(i.widget),r=$gridster.next_position(u.dataSizeX,u.dataSizeY),e=t.find("#class_"+n).val();$gridster.add_widget('<li class="'+e+'" id="'+n+'">'+f+"<\/li>",r.size_x,r.size_y,r.col,r.row);t.remove();saveWidgetGrid();loadScrollWidget()},error:function(){loadDialogMessage(null,"Erreur",!1)}})})}function saveWidgetGrid(){var n=JSON.stringify($gridster.serialize());$.post($("#hid_urlSyntheseWidgetSave").val(),{name:$("#hid_nameSyntheseWidget").val(),widget:n})}for(var idtr_selected_detail_row,buttonConfirm,buttonOk,widthContainerWidget,$gridster,pathURLArray=window.location.pathname.split("/"),urlAjax="",tabInHash=Array("ong"),regHash=new RegExp("[0-9_-]+","g"),regInt=new RegExp("[^0-9]+","g"),iUrl=1;iUrl<pathURLArray.length-1;iUrl++)urlAjax+="/"+pathURLArray[iUrl];$.fn.clearForm=function(){return this.each(function(){var n=this.type,t=this.tagName.toLowerCase();if(t=="form")return $(":input",this).clearForm();n=="text"||n=="password"||t=="textarea"?$(this).data("kendoDropDownList")?$(this).data("kendoDropDownList").value(""):this.value="":n=="checkbox"||n=="radio"?this.checked=!1:t=="select"&&(this.selectedIndex=-1)})};idtr_selected_detail_row="";buttonConfirm='<div class="div_confirm_window"><button class="b-confirm k-button k-primary">Oui<\/button><button class="b-cancel k-button">Non<\/button><\/div>';buttonOk='<div class="div_confirm_window"><button class="b-cancel k-button k-primary">OK<\/button><\/div>';widthContainerWidget=0;